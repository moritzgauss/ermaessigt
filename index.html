<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generate Your Student ID Card</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        h1 {
            text-align: center;
        }

        .input-fields {
            margin-bottom: 20px;
        }

        .input-fields input {
            display: block;
            margin: 10px 0;
            padding: 10px;
            font-size: 16px;
            width: 300px;
        }

        .canvas-container {
            position: relative;
        }

        canvas {
            border: 2px solid black;
            margin-top: 20px;
        }

        .button-container {
            position: absolute;
            right: 0;
            top: -40px;
            display: flex;
            gap: 10px;
        }

        #downloadButton, #clearCanvasButton {
            margin-top: 20px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
        }

        #studentImage {
            width: 200px;
            height: 100px;
            object-fit: cover; /* Ensure the image doesn't stretch but covers the area */
        }

    </style>
</head>
<body>

    <h1>Generate Your Student ID Card</h1>

    <!-- Input fields for the user to fill out -->
    <div class="input-fields">
        <input type="text" id="studentId" placeholder="Student Number?" maxlength="7">
        <input type="text" id="lastName" placeholder="Last name?">
        <input type="text" id="firstName" placeholder="First name?">
        <input type="text" id="additionalText" placeholder="Year?">
        <input type="file" id="imageUpload" accept="image/*">
    </div>

    <!-- The Canvas and button container -->
    <div class="canvas-container">
        <canvas id="idCardCanvas" width="956" height="640"></canvas>
        
        <!-- Buttons for adding a random logo, switching to English ID, and clearing the canvas -->
        <div class="button-container">
            <button id="randomLogoButton">Add Random Logo</button>
            <button id="switchLanguageButton">English ID</button>
            <button id="showBackButton">Show Back of ID</button>
        </div>
    </div>

    <button id="downloadButton">Download ID as PNG</button>
    <button id="clearCanvasButton">Clear Canvas</button>

    <script>
        const canvas = document.getElementById('idCardCanvas');
        const ctx = canvas.getContext('2d');
        let isEnglish = false; // Track the language state
        let isBackShown = false; // Track if the back of the ID is shown

        // Default ID layout dimensions
        const cardWidth = canvas.width;
        const cardHeight = canvas.height;

        // Drawing the card with initial layout
        function drawCard() {
            ctx.clearRect(0, 0, cardWidth, cardHeight); // Clear the canvas

            // Drawing ID Card Outline
            ctx.strokeStyle = 'black';
            ctx.lineWidth = 2;
            ctx.strokeRect(20, 20, cardWidth - 40, cardHeight - 40);

            // Drawing placeholders for text and images
            ctx.fillStyle = 'black';
            ctx.font = 'bold 28px Roboto';

            // Text Positioning
            ctx.fillText('Student ID', 60, 70); // Title

            // Personal Info Placement
            ctx.font = 'bold 24px Roboto';
            const lastName = document.getElementById('lastName').value || "Max";
            const firstName = document.getElementById('firstName').value || "Mustermann";
            const studentId = document.getElementById('studentId').value || "1234567";

            ctx.fillText(`${firstName} ${lastName}`, 60, 160); // Full name
            ctx.fillText(`Matnr.: ${studentId}`, 60, 220); // Student number

            // Additional info text
            const additionalText = document.getElementById('additionalText').value || "Valid until 14.03.24";
            ctx.fillText(`${additionalText}`, 60, 280); // Additional text

            // Placeholder for Image
            ctx.strokeRect(650, 40, 200, 100); // Placeholder for student image (200x100px)

            // Logo placeholder
            ctx.strokeRect(850, 40, 100, 100); // Placeholder for logo image (100x100px)

            // Barcode area
            ctx.fillRect(60, 500, 400, 80); // Placeholder for barcode
        }

        // Function to load uploaded image onto the canvas
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            const reader = new FileReader();
            reader.onload = function(event) {
                const img = new Image();
                img.onload = function() {
                    ctx.clearRect(650, 40, 200, 100); // Clear the image placeholder
                    ctx.drawImage(img, 650, 40, 200, 100); // Draw uploaded image
                }
                img.src = event.target.result;
            }
            reader.readAsDataURL(e.target.files[0]);
        });

        // Function to add random logo to the canvas
        document.getElementById('randomLogoButton').addEventListener('click', function() {
            const img = new Image();
            img.onload = function() {
                ctx.clearRect(850, 40, 100, 100); // Clear the logo placeholder
                ctx.drawImage(img, 850, 40, 100, 100); // Draw the random logo
            }
            img.src = 'https://via.placeholder.com/100'; // Placeholder image for random logo
        });

        // Function to switch between German and English layouts
        document.getElementById('switchLanguageButton').addEventListener('click', function() {
            isEnglish = !isEnglish;
            drawCard(); // Redraw the card with the new language
        });

        // Download functionality
        document.getElementById('downloadButton').addEventListener('click', function() {
            const link = document.createElement('a');
            link.download = 'student_id.png';
            link.href = canvas.toDataURL();
            link.click();
        });

        // Clear canvas functionality
        document.getElementById('clearCanvasButton').addEventListener('click', function() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            drawCard(); // Redraw the default card layout after clearing
        });

        // Initial draw on page load
        drawCard();

    </script>

</body>
</html>